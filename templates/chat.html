<!-- This is Cloudi's chat page -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cloudi â˜ï¸ - Your Internship Assistant</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>

<body>

  <h1 class="cloudi-title">{{ intro_message }}</h1>
  <p class="cloudi-sub">{{ sub_message }}</p>

  <!-- Theme + Voice Toggles -->
  <div class="toggle-container">
    <button id="theme-toggle" onclick="toggleDarkMode()">ğŸŒ™</button>
    <button id="muteToggle" class="theme-toggle">ğŸ”Š</button>
  </div>

  <!-- Chat Analytics -->
  <div class="analytics-link">
  <a href="/analytics" class="analytics-btn">ğŸ“Š View Analytics</a>
</div>


  <!-- Chat Form -->
  <form action="/chat" method="POST" class="chat-form">
    <label for="personality">Choose Cloudi's Mood:</label><br />
    <select name="personality" id="personality">
      <option value="friendly">ğŸ˜‡ Friendly</option>
      <option value="sassy">ğŸ˜ Sassy</option>
      <option value="formal" selected>ğŸ“š Formal</option>
    </select>

    <div class="input-group">
      <input
        type="text"
        id="message"
        name="message"
        placeholder="Type your question or click the mic ğŸ¤"
        required
      />
      <button type="submit">Ask Cloudi</button>
      <button type="button" onclick="startListening()">ğŸ¤</button>
    </div>
  </form>

  <!-- Footer -->
  <footer class="cloudi-footer">
    <p>Powered by <strong>Cloud Counselage</strong></p>
    <p>Â© Vedika Dabade. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script>
    // Dark Mode Toggle
    function toggleDarkMode() {
      document.body.classList.toggle('dark');
      const isDark = document.body.classList.contains('dark');
      document.getElementById('theme-toggle').textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
      localStorage.setItem('darkMode', isDark);
    }

    // Apply user theme preference on load
    window.onload = () => {
      const prefersDark = localStorage.getItem('darkMode') === 'true';
      if (prefersDark) {
        document.body.classList.add('dark');
        document.getElementById('theme-toggle').textContent = 'â˜€ï¸';
      }

      // Voice toggle icon
      const isMuted = localStorage.getItem('cloudiMuted') === 'true';
      document.getElementById('muteToggle').textContent = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';
    };

    // Voice toggle button
    const muteBtn = document.getElementById('muteToggle');
    if (muteBtn) {
      muteBtn.addEventListener('click', () => {
        const muted = localStorage.getItem('cloudiMuted') === 'true';
        localStorage.setItem('cloudiMuted', !muted);
        muteBtn.textContent = muted ? 'ğŸ”Š' : 'ğŸ”‡';
      });
    }

    // Speech-to-Text
    function startListening() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'en-US';
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;

      recognition.onresult = function (event) {
        const transcript = event.results[0][0].transcript;
        document.getElementById('message').value = transcript;
        document.querySelector('form').submit();
      };

      recognition.onerror = function (event) {
        alert('Speech recognition error: ' + event.error);
      };

      recognition.start();
    }
  </script>

</body>
</html>
